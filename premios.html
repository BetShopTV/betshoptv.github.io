
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="icon" href="https://betshoptv.com/FAVICON.png" type="image/x-icon">
<title>BetShopTV - Sele√ß√£o de Pr√™mios</title>

<style>
  /* --- Tokens & Reset --- */
  :root{
    --red:#ff0000; --ink:#2b2424; --beige:#bebab0; --white:#ffffff;
    --bd-thin:1px; --bd-thick:2px;
    --ff-normal:"Roboto", system-ui, -apple-system, sans-serif;
    --ff-cta:"Roboto Condensed", system-ui, -apple-system, sans-serif;
    --ff-body:"Roboto SemiCondensed", system-ui, -apple-system, sans-serif;
    --fs-sm:clamp(.78rem,1vw,.9rem);
    --destaque: clamp(2.4rem,3.8vw, 2.7rem);
    --app-max-width:1200px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0.18vw;background:var(--beige);color:var(--ink);font-family:var(--ff-body);-webkit-font-smoothing:antialiased} 

/* --- HEADER COM EFEITO SHRINK --- */
/* --- HEADER SHRINK (DRAM√ÅTICO & LIMPO) --- */
 /* --- Header Limpo (Ajustado para Alinhamento) --- */
  header {
    /* ... (Mant√©m o resto do seu estilo de header, incluindo o shrink) */
    position: sticky; top: 0; z-index: 100;
  }

  .hdr-inner {
    max-width: var(--app-max-width); /* Mant√©m o limite de largura */
    margin: 0 auto;
    
    /* 1. Alinha o conte√∫do √† esquerda */
    display: flex;
    align-items: center;
    justify-content: flex-start; /* <<< MUDAN√áA CR√çTICA: Alinha √† esquerda */
    
    /* 2. Aplica a mesma margem da galeria */
    padding: 20px 6px; /* Padding vertical mantido, 6px horizontal igual ao main#app */
    transition: padding .3s ease;
  }
  
  .logo img { 
    display: block; 
    width: auto; 
    height: clamp(88px, 16.9vw, 150px); /* Mant√©m o clamp chiqu√©rrimo */
    transition: height .3s ease;
    will-change: height;
    margin-left: 11px;
        margin-top: 12px; /* <--- O SEGREDINHO AQUI (Ajuste o n√∫mero se precisar) */
  }
  
  /* Mant√©m o shrink: */
  header.scrolled .hdr-inner {
    padding: 6px 6px; /* Alinha o padding horizontal do shrink */
  }
  header.scrolled .logo img {
    height: clamp(40px, 10vw, 88px);
  }
  /* --- Layout Principal --- */
  main#app{max-width:var(--app-max-width);margin:20px auto;padding:0 6px;min-height:80vh}

  /* --- Barra de Filtros (Simplificada) --- */
  .filters-bar{ display:flex; flex-wrap:wrap; justify-content:center; gap:10px; padding:10px 0 20px 0; border-bottom: 1px solid var(--ink); margin-bottom: 20px; }
  .filters-group{ display: inline-flex; flex-wrap: wrap; gap: 6px; align-items: center;}
  .filters-label{ font:700 var(--fs-sm)/1 var(--ff-cta); color:var(--ink); margin-right: 4px; text-transform: uppercase;}
  
  .chip, .select { appearance:none; margin-top: -18px; border:1px solid var(--ink); background:var(--ink); color:var(--beige); padding: 1.5vw 1.73vw; min-height:50px; max-height: 8.8vh; font:500 calc(var(--fs-sm) * 1.38)/1 var(--ff-cta); cursor:pointer; display:inline-flex; align-items:center; justify-content:center; }
  .chip.is-active { background:var(--ink) ; color:var(--beige); border-color:var(--ink); }
  .select:focus { outline:none!important; }

  /* --- Galeria (Masonry) --- */
  .galeria-container { display:flex; gap:6px; align-items:flex-start; }
  .gal-col { flex:1; display:flex; flex-direction:column; gap:6px; min-width: 0;}
  
  .gal-item { position: relative; width:100%; display:block; cursor: pointer; transition: transform 0.1s; }
  .gal-item:hover img { filter: brightness(1.1); }

  .gal-item img {
    display:block; width:100%; height:auto; object-fit:cover;
    border: 1px solid var(--ink);
    transition: all 0.2s ease;
  }

/* --- Estados de Sele√ß√£o --- */
  
  /* 1. Imagem: PB + Opacidade 50% */
  .gal-item.selected img {
    filter: grayscale(100%);
    opacity: 0.94; /* Adiciona a transpar√™ncia */
    border: 1px solid var(--ink);
    box-sizing: border-box;
  }

  /* 2. Badge Num√©rico: Centralizado */
  .selection-badge {
    position: absolute;
    
    /* Centraliza√ß√£o Perfeita */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    
    /* Tamanho solicitado */
    width: 24%;
    height: 24%;
    
    /* Visual */
    background-color: var(--red);
    color: white;
    font-family: var(--ff-cta);
    
    /* Flex para centralizar o n√∫mero dentro do badge */
    display: none; 
    align-items: center; 
    justify-content: center;
    
    font-weight: bold; 
    font-size: clamp(24px, 2.4vw, 37px); /* Ajustei fonte para caber no 18% */
    z-index: 20; 
    pointer-events: none;
  }

  /* Mostra o badge apenas quando selecionado */
  .gal-item.selected .selection-badge { 
    display: flex; 
  }
/* --- 3. T√≠tulo Fixo na Base (Atualizado para Flex) --- */
.gal-titulo {
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    gap: 4px; /* Espa√ßo m√≠nimo vital */
    width: 100%;
    background-color: var(--beige); 
    color: var(--ink);
    padding: 4px 6px; /* Padding reduzido para ganhar espa√ßo */
    margin-top: -1px;
    box-sizing: border-box;
    border: 1px solid #2b2424;
    margin-bottom: 24px;
  }
  
  /* Texto do t√≠tulo */
  .gal-titulo-text {
    /* Fonte levemente ajustada para caber */
    font-weight: 600;
    font-size: clamp(11px, 2vw, 15px);
    margin-left: clamp(0px, 1vw, 13px);
    margin-top: clamp(0px, 1vw, 4px);
    margin-bottom: clamp(0px, 1vw, 4px);
    white-space: nowrap; 
    overflow: hidden; 
    text-overflow: ellipsis; /* Tr√™s pontinhos (...) se n√£o couber */
    
    /* FLEX MAGIC: */
    flex: 1;      /* Ocupa todo o espa√ßo dispon√≠vel */
    min-width: 0; /* OBRIGAT√ìRIO para ellipsis funcionar em flexbox */
    text-align: left;
  }

  /* Bot√£o Espiar [ + ] */
  /* --- Bot√£o Sat√©lite (Overlay na Imagem) --- */
  .btn-spy {
    position: absolute;
    top: -10px; 
    right: 0;
    z-index: 10;
    
    /* CLAMP CHIQUE: Responsividade fluida */
    /* Mobile: 34px | Desktop: cresce at√© 44px */
    width: clamp(20px, 2vw, 38px);
    height: clamp(20px, 2vw, 38px);
    
    /* Fonte escala junto para o + ficar sempre centralizado e proporcional */
    font-size: clamp(18px, 2vw, 27px);
    
    /* Visual */
    background: var(--beige); 
    color: var(--ink);
    border: 1px solid var(--ink);

    font-family: var(--ff-normal);
    font-weight: 300; 
    line-height: 1;
    padding: 0;
    
    display: flex; align-items: center; justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .btn-spy:hover {
    background: var(--ink);
    color: var(--beige);
  }

  /* --- MODAL DE DETALHES (Espiar) --- */
 /* --- MODAL DE DETALHES (Visualizador Imersivo) --- */
/* --- MODAL DE DETALHES (Visualizador Imersivo) --- */
  .details-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.9); /* Fundo bem escuro */
    z-index: 300; display: none; justify-content: center; align-items: center;
    opacity: 0; transition: opacity 0.3s; backdrop-filter: blur(5px);
  }
  .details-overlay.open { display: flex; opacity: 1; }

  .details-card {
    background: var(--white);
    /* Tamanhos mantidos do seu c√≥digo */
    width: 95%; max-width: 800px;
    height: 90vh; max-height: 900px;
    border: 1px solid var(--ink);
    position: relative;
    display: flex; flex-direction: column;
    box-shadow: 0 20px 50px rgba(0,0,0,0.5);
  }

  /* Container da Imagem (Scroll Nativo Habilitado) */
  .details-img-container {
    background: #f0f0f0; /* Fundo cinza claro mantido */
    flex: 1;
    position: relative;
    
    /* MUDAN√áA: Habilita Scroll Nativo Horizontal */
    display: flex;
    overflow-x: auto;      /* Permite rolar */
    overflow-y: hidden;
    scroll-snap-type: x mandatory; /* Obriga a parar na imagem certa */
    scroll-behavior: smooth;
    
    /* Remove barra de rolagem visualmente */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  .details-img-container::-webkit-scrollbar { display: none; }

  /* As Imagens */
  .details-img {
    flex: 0 0 100%; /* Ocupa 100% da largura do container */
    width: 100%; height: 100%;
    object-fit: contain; /* Garante imagem inteira sem cortes */
    display: block;
    scroll-snap-align: center; /* Alinha ao centro ao soltar */
  }

  /* √Årea dos Quadrados (Dots) */
  .car-dots-area {
    background: var(--white);
    padding: 12px 0 8px; /* Espa√ßo mantido */
    display: flex; justify-content: center; gap: 8px;
    border-bottom: 1px solid #eee;
    flex-shrink: 0;
  }
  
  /* Quadrados (Estilo mantido) */
  .dot {
    width: 10px; height: 10px;
    background: #ccc;
    border-radius: 0; /* QUADRADO */
    transition: background 0.2s;
  }
  .dot.active { background: var(--red); }

  /* Informa√ß√µes + Bot√£o Selecionar */
  .details-info { 
    padding: 15px 20px; 
    background: var(--white);
    flex-shrink: 0; /* N√£o encolhe */
  }

  /* Layout Flex para alinhar Texto (Esq) e Bot√£o (Dir) */
  .details-header-row {
    display: flex; 
    justify-content: space-between; 
    align-items: flex-start; 
    gap: 15px;
  }
  
  .details-texts { flex: 1; text-align: left; }

  /* Tipografia (Mantida exata) */
  .details-title { 
    font-family: var(--ff-cta); font-size: 1.2rem; font-weight: 700; 
    text-transform: uppercase; color: var(--ink); margin-bottom: 4px; line-height: 1.1;
  }
  .details-tech { 
    font-family: var(--ff-body); font-size: 0.95rem; font-weight: 600; 
    color: #555; margin-bottom: 4px; 
  }
  .details-dim { 
    font-family: var(--ff-body); font-size: 0.9rem; color: #777; 
  }

  /* Novo Bot√£o SELECIONAR dentro do modal */
  .btn-modal-select {
    background: var(--white);
    color: var(--ink);
    border: 1px solid var(--ink);
    padding: 10px 16px;
    font-family: var(--ff-cta); font-weight: 700; text-transform: uppercase;
    font-size: 0.9rem;
    cursor: pointer; white-space: nowrap; transition: all 0.2s;
    min-width: 120px;
  }
  .btn-modal-select:hover { background: var(--ink); color: var(--white); }
  
  /* Estado Selecionado (Vermelho) */
  .btn-modal-select.is-selected {
    background: var(--red); color: var(--white); border-color: var(--red);
  }

  /* Bot√£o Fechar (Estilo mantido exato) */
  .btn-close-details {
    position: absolute; top: -15px; right: -15px;
    background: #f0f0f0; color: var(--red);
    border: 4px solid rgba(0, 0, 0, 0.9);
    width: 37px; height: 37px; border-radius: 50%;
    font-size: 1rem; font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; z-index: 20;
  }
  .btn-close-details:hover { transform: scale(1.1); }

  /* --- Footer --- */
  footer { position:sticky; bottom:0; background:var(--ink); color:#fff; padding: 12px; text-align: center; font-family: var(--ff-cta); font-weight: 700; z-index: 100; display:flex; justify-content:center; gap:15px; align-items:center; }
  .pill-counter { ; }
  .btn-submit { background:var(--beige); color:var(--ink); border: 2px solid #2b2424; padding:10px 20px; font-weight:700; cursor:pointer; font-size:0.88em; letter-spacing:1px; }
  .btn-submit:disabled { opacity:0; cursor:not-allowed; background:#555; }

  /* --- Formul√°rio Checkout --- */
  .checkout-container { max-width:500px; margin:20px auto; text-align:left; background:var(--white); border:2px solid var(--ink); padding:20px; }
  .checkout-container h2 { color:var(--red); text-transform:uppercase; margin-top:0; }
  .form-group { margin-bottom:15px; }
  .form-group label { display:block; font-weight:700; margin-bottom:5px; font-family:var(--ff-cta); }
  .form-group input { width:100%; padding:10px; border:1px solid var(--ink); font-family:var(--ff-body); border-radius:0; }
  .btn-back { background:transparent; border:1px solid var(--ink); padding:8px 16px; cursor:pointer; margin-right:10px; font-weight:700; }


/* --- Painel de Revis√£o (Drawer) --- */
.review-panel {
  position: fixed; bottom: 0; left: 0; width: 100%;
  background: var(--beige); border-top: 2px solid var(--ink);
  z-index: 150; /* Acima do footer */
  transform: translateY(110%); /* Escondido por padr√£o */
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex; flex-direction: column;
  max-height: 66vh; /* Ocupa at√© 80% da tela */
} 

.review-panel.open { transform: translateY(0); }

.review-header {
  padding: 15px; background: var(--ink); color: var(--white);
  display: flex; justify-content: space-between; align-items: center;
  font-family: var(--ff-cta); font-weight: 700; text-transform: uppercase;
}

.review-body {
  flex: 1; overflow-y: auto; padding: 15px;
  background: #bebab0;
}

/* Item da Lista de Revis√£o */
/* --- Painel de Revis√£o (Minimalista) --- */
.review-panel {
  position: fixed; bottom: 0; left: 0; width: 100%;
  background: var(--beige); 
  border-top: 2px solid var(--ink); /* Topo vermelho sutil */
  z-index: 150;
  transform: translateY(110%);
  transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1); /* Anima√ß√£o elegante */
  display: flex; flex-direction: column;
  max-height: 50vh;
}

.review-panel.open { transform: translateY(0); }

/* Cabe√ßalho Limpo */
.review-header {
  padding: 15px; 
  background: var(--ink); 
  color: var(--beige);
  border-bottom: 1px solid var(--ink);
  display: flex; justify-content: space-between; align-items: center;
  font-family: var(--ff-cta); font-weight: 700; text-transform: uppercase;
  letter-spacing: 1px;
}

/* Corpo da Lista */
.review-body {
  flex: 1; 
  overflow-y: auto;       /* Scroll vertical permitido */
  overflow-x: hidden;     /* Scroll horizontal PROIBIDO (Tiro e queda) */
  padding: 0 5%;          /* Mudei de 10vh pra 5% pra ser mais responsivo */
  background: var(--beige);
}
  .review-body::-webkit-scrollbar{width:8px; border-radius:0;}
  .review-body::-webkit-scrollbar-track{background:var(--beige);border-radius:0;}
  .review-body::-webkit-scrollbar-thumb{background:var(--red)}

/* Item da Lista (Design 'Flat') */
.review-item {
  display: flex; align-items: center; gap: 15px;
  background: var(--beige); 
  border-bottom: 1px solid #2b2424; /* Divis√≥ria muito sutil */
  padding: 10px 20px;
}

/* Numera√ß√£o (1, 2, 3...) */
.review-rank { 
  font-family: var(--ff-cta); 
  font-weight: 700; 
  font-size: 1.1rem; 
  color: var(--ink); 
  width: 25px; 
  text-align: center;
}

/* Imagem (Sem Crop) */
.review-thumb { 
  height: 80px; /* Altura fixa para alinhar a lista */
  width: auto;  /* Largura adapta-se √† propor√ß√£o */
  max-width: 138px; /* Limite para n√£o estourar em horizontais */
  object-fit: contain; /* O SEGREDO: Mostra a imagem inteira sem cortar */
  background-color: #f9f9f9; /* Fundo discreto se a imagem for transparente/estreita */
  border: 1px solid #2b2424;
}

/* Informa√ß√µes */
.review-info { flex: 1; display: flex; flex-direction: column; justify-content: center;}
.review-title { 
  font-family: var(--ff-body); 
  font-size: clamp(0.73em, 1.3vw, 1em);
  font-weight: 500;
  color: var(--ink); 
  line-height: 1.2;
  text-align: left;
}

/* A√ß√µes (Setas e Lixo) */
.review-actions { display: flex; gap: 5px; }

.ctrl-btn {
  background: transparent; 
  border: 1px solid var(--ink); color: var(--ink);
  width: 24px; height: 32px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 0.6rem; transition: all 0.2s;
}

/* Bot√£o de Remover (Destaque sutil no hover) */
.ctrl-btn.remove { 
  border: 1px solid var(--red); 
  color: var(--red); 
}

/* Bot√£o Fechar Painel */
.btn-close-panel { 
  background: transparent; border: 0; 
  color: var(--white); font-size: 1rem; cursor: pointer; 
  line-height: 1; padding: 0 10px;
}


/* --- ESTILOS DO FLUXO DE DOA√á√ÉO --- */
.envio-modal-overlay {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(43, 36, 36, 0.7); backdrop-filter: blur(4px);
  display: none; justify-content: center; align-items: center; z-index: 200;
  opacity: 0; transition: opacity 0.3s ease;
}
.envio-modal-overlay.open { display: flex; opacity: 1; pointer-events: all; }

.envio-card {
  background: var(--white); border: 2px solid var(--ink);
  width: 90%; max-width: 666px; padding: 30px; text-align: center;
  box-shadow: 0 20px 50px rgba(0,0,0,0.3); position: relative;
  transform: translateY(20px); transition: transform 0.3s ease;
}
.envio-modal-overlay.open .envio-card { transform: translateY(0); }

/* Telas e Transi√ß√µes */
.screen { display: none; animation: fadeIn 0.3s; }
.screen.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

/* Tipografia e Inputs */
.envio-title { font-family: var(--ff-cta); font-weight: 700; text-transform: uppercase; color: var(--red); font-size: 1.4rem; margin-bottom: 10px; }
.envio-desc { font-size: 0.95rem; color: #555; margin-bottom: 20px; line-height: 1.4; }

.input-field { 
  width: 100%; padding: 12px; border: 1px solid var(--ink); 
  font-family: var(--ff-body); font-size: 1rem; margin-bottom: 15px; 
  text-align: center; border-radius: 0; 
}
.input-field:focus { border-color: var(--red); outline: none; }

/* Bot√µes */
.btn-confirm { 
  width: 100%; padding: 14px; background: var(--ink); color: white; 
  border: 0; font-family: var(--ff-cta); font-weight: 700; letter-spacing: 1px; 
  cursor: pointer; font-size: 1rem; text-transform: uppercase; 
}
.btn-confirm:hover { background: var(--red); }

.btn-cancel { 
  background: transparent; border: 0; text-decoration: underline; 
  color: #777; font-size: 0.85rem; margin-top: 15px; cursor: pointer; 
}

/* Lista de Doa√ß√µes */
.donation-list-container { max-height: 35vh; overflow-y: auto; margin: 0 -20px 15px; padding: 0 20px; border-top: 1px solid #eee; border-bottom: 1px solid #eee; }
.donation-list-container::-webkit-scrollbar{width:8px; border-radius:0;}
.donation-list-container::-webkit-scrollbar-track{background:var(--white);border-radius:0;}
.donation-list-container::-webkit-scrollbar-thumb{background:var(--red)}


.donation-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
/* --- ALINHAMENTO PERFEITO DA LISTA --- */

.donation-info { 
  flex: 1; 
  padding-right: 10px; 
  
  /* A M√°gica do Alinhamento: */
  display: flex;             /* Transforma em container flex√≠vel */
  flex-direction: column;    /* Empilha: Um em cima do outro */
  align-items: flex-start;   /* Trava tudo na esquerda */
  justify-content: center;   /* Centraliza verticalmente no bloco */
  text-align: left;          /* Garante que o texto obede√ßa */
}

.d-name { 
  font-weight: 700; 
  color: var(--ink); 
  font-size: 0.9rem; 
  line-height: 1.2;          /* Evita que nomes longos fiquem muito espa√ßados */
  margin-bottom: 2px;        /* Espacinho m√≠nimo antes do pre√ßo */
  display: block;
}

.d-price { 
  color: var(--red); 
  font-weight: 600; 
  font-size: 0.85rem; 
  display: block;            /* Garante que o pre√ßo ocupe a pr√≥pria linha */
}

.d-controls { display: flex; align-items: center; gap: 8px; }
.d-btn { width: 28px; height: 28px; background: white; border: 1px solid var(--ink); display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: 700; }
.d-qty { font-weight: 700; width: 20px; text-align: center; }

/* Valor Livre e Total */
.free-value-box { background: white; border: 2px solid var(--ink); padding: 12px; margin-bottom: 15px; text-align: left; }
.free-label { font-family: var(--ff-cta); font-weight: 700; color: var(--ink); font-size: 0.85rem; text-transform: uppercase; }
.free-input-wrapper { display: flex; align-items: center; border-bottom: 1px solid var(--ink); }
#free-input { border: 0; font-size: 1.6rem; font-weight: 700; color: var(--red); width: 100%; outline: none; padding: 5px 0; font-family: var(--ff-cta); }

.total-bar { background: var(--ink); color: white; padding: 15px; margin: 0 -30px -30px; display: flex; justify-content: space-between; align-items: center; }
.total-val { font-size: 1.2rem; font-weight: 700; font-family: var(--ff-cta); }
.btn-pay { background: var(--red); border: 0; color: white; padding: 8px 16px; font-weight: 700; cursor: pointer; }
.btn-pay:disabled { background: #555; cursor: default; opacity: 0.7; }

.custom-item-btn { width: 100%; border: 1px dashed var(--ink); background: transparent; padding: 10px; font-weight: 700; color: var(--ink); cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; justify-content: center; gap: 5px; }

/* --- TELA PIX (LAYOUT CORRIGIDO) --- */
.pix-qr-box {
  background: #fff;
  padding: 10px;
  border: 2px solid var(--ink);
  display: inline-block;
  margin-bottom: 15px;
}
.pix-img {
  width: 180px; height: 180px; /* Tamanho fixo seguro */
  display: block;
  object-fit: contain;
}
.pix-total-display {
  font-family: var(--ff-cta);
  font-size: 1.6rem;
  color: var(--red);
  font-weight: 700;
  margin-bottom: 15px;
  display: block;
}
.pix-copy-row {
  display: flex; gap: 5px; margin-bottom: 8px;
  max-width: 100%; /* Segura para n√£o estourar */
}
.pix-input-readonly {
  flex: 1; /* Ocupa o espa√ßo que der */
  font-size: 0.85rem; color: #555;
  padding: 10px;
  border: 1px solid var(--ink);
  background: #f4f4f4;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis; /* Corta texto longo */
  font-family: monospace;
  border-radius: 0;
}
.btn-copy {
  background: var(--ink); color: #fff;
  border: 0; font-weight: 700;
  padding: 0 15px; cursor: pointer;
  font-family: var(--ff-cta);
  white-space: nowrap;
}
.btn-copy:active { background: var(--red); }
.msg-success-copy { color: #27ae60; font-weight: bold; font-size: 0.8rem; display: none; margin-bottom: 15px; }


/* --- ACCORDION DE BOAS-VINDAS (Abaixo do Header) --- */
/* --- ACCORDION ALINHADO (WOW EFFECT) --- */
.welcome-section {
  background: var(--ink); /* Fundo preto total */
  margin-bottom: 24px;
  margin-top: -127px;
  width: 100%;
}

/* O Segredo do Alinhamento üëá */
.w-wrapper {
  max-width: calc(var(--app-max-width) / 3 );
  margin: 0 auto;                  /* Centraliza */
  padding: 0 6px;                  /* Mesma sangria do app */
}

.welcome-header {
  padding: 8px 10px;
  text-align: center;
  color: var(--beige);
}

.welcome-title {
  font-family: var(--ff-cta); font-weight: 700; font-size: 1.4rem; 
  letter-spacing: 0.6px; text-transform: uppercase; margin: 0; color: var(--ink);
}
.welcome-subtitle {
  font-family: var(--ff-body); color: var(--ink); font-size: 0.8rem; margin-top: 8px; margin-bottom: 8px;
}

/* Accordion */
.w-accordion {
  background: var(--white);
  border-top: 1px solid #2b2424;
  /* Sem borda superior para colar no header visualmente, ou com borda se preferir separado */
}

.w-details {
  border: 1px solid #2b2424;
  border-top: 0px;
  background: var(--beige);
  transition: background 0.2s;
}
.w-details[open] { background: #fff;}

.w-summary {
  list-style: none; padding: clamp(3px, 1vw, 12px) 20px; cursor: pointer;
  display: flex; align-items: center; justify-content: space-between;
  font-family: var(--ff-cta); font-weight: 700; text-transform: uppercase;
  font-size: 0.95rem; color: var(--ink); user-select: none;
}
.w-summary::-webkit-details-marker { display: none; }

.w-summary::after {
  content: '+'; font-size: 1.4rem; font-weight: 300; color: var(--red);
  transition: transform 0.3s;
}
.w-details[open] .w-summary::after { content: '‚àí'; transform: rotate(180deg); }

.w-content {
  padding: 0 20px 20px 60px;
  font-family: var(--ff-body); font-size: 0.95rem; line-height: 1.5; color: #555;
  text-align: left; animation: slideDown 0.3s ease-out;
}
.w-icon { font-size: clamp(1.24rem, 2vw, 1.4rem); margin-right: 13px; width: 25px; text-align: center; margin-left: -8px; }
@keyframes slideDown { from { opacity:0; transform:translateY(-5px); } to { opacity:1; transform:translateY(0); } }

/* --- TELA PIX (ESTILO BAFO) --- */
/* --- TELA PIX (BRUTALISTA SECO) --- */
.pix-wrapper {
  display: flex; flex-direction: column; align-items: center; text-align: center;
  gap: 15px; margin-top: 10px;
}

/* Moldura simples: Linha preta, fundo branco */
.pix-qr-frame {
  background: var(--white);
  padding: 8px;
  border: 2px solid var(--ink);
  margin-bottom: 5px;
}

.pix-img {
  width: 180px; height: 180px; 
  display: block; object-fit: contain;
  image-rendering: pixelated;
}

.pix-label {
  font-family: var(--ff-cta); text-transform: uppercase; 
  font-size: 0.8rem; letter-spacing: 1px; color: var(--ink);
  margin-bottom: 4px; display: block;
}

.pix-value {
  font-family: var(--ff-cta); 
  font-size: 2.2rem; 
  color: var(--red); 
  font-weight: 700; 
  line-height: 1;
}

/* Barra de C√≥pia: Bloco s√≥lido */
.pix-copy-box {
  display: flex; width: 100%; 
  border: 2px solid var(--ink);
  background: var(--white);
  height: 40px;
}

.pix-input {
  flex: 1; border: none; background: transparent; padding: 0 10px;
  font-family: monospace; font-size: 0.85rem; color: #555;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  outline: none;
}

.pix-btn-copy {
  background: var(--ink); color: var(--white);
  border: none; border-left: 2px solid var(--ink);
  font-family: var(--ff-cta); font-weight: 700; letter-spacing: 0.5px;
  padding: 0 20px; cursor: pointer;
  min-width: 100px; /* Garante que o texto caiba quando mudar */
}
.pix-btn-copy:hover { background: var(--red); }


  @media (max-width:768px){ .filters-bar { gap: 8px; } 
      .review-body {
  padding: 0px 1.8vh; /* Sem padding para as bordas encostarem */
  }
  
  .welcome-section {
  margin-top: 0px;
 }
</style>



</head>
<body>

<header>
    <div class="hdr-inner">
      <a class="logo" href="#" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">
          <img src="https://betshoptv.com/elementos/logo-bstv.png" alt="BetShopTV" />
      </a>
      
<button 
  id="btn-copiar-selecao" 
  class="chip" 
  disabled 
  style="
    margin-left: auto; /* Empurra para a direita */
    text-align: left;
  font-size: clamp(14px, 2.5vw, 22px);
  font-weight: 600; 
  height: clamp(36px, 8vw, 188px);
  padding: clamp(24px, 3vw, 30px) clamp(8px, 3vw, 18px);
  letter-spacing: 0.5px;
  line-height: 1.3em;
    /* ESTADO INICIAL: Bege (Fundo), Vermelho (Borda/Texto) */
    background: transparent;
    color: var(--red);
    border: 1px solid var(--red);
    cursor: default; /* Inativo por padr√£o */
    margin-right: 11px;
        margin-top: 12px; /* <--- O SEGREDINHO AQUI (Ajuste o n√∫mero se precisar) */
  "
  onclick="copyListToClipboard()"
>
  SELECIONE
  <br>P/ COPIAR
</button>

<textarea id="lista-copiar-oculta" style="position: absolute; left: -9999px;"></textarea>
      </div>
  </header>

<section class="welcome-section" style="background-color: #bebab0;">
    <div class="w-wrapper"> <div class="welcome-header" style=" margin-bottom: 13px; background: red;">
        <h2 class="welcome-title" style="color: white; background:red; font-weight: 400; padding: 8px; border-bottom: 1px solid white; ">VOC√ä GANHOU <strong>3</strong> PE√áAS!</h2>
        <div style="margin-top: 8px;"><span class="welcome-subtitle" style="padding: 6px 9px; color: white;"><strong>Clique nas imagens</strong> para selecion√°-las&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;e nos itens abaixo para saber mais.</span></div>
      <div style="margin-top: 8px;"></div>
      </div>

      <div class="w-accordion">
        
        <details class="w-details">
          <summary class="w-summary">
            <div style="display:flex; align-items:center;"><span class="w-icon" style="font-size: 24px; font-weight: 500; margin-top: -2px; margin-left: 2px;">‚òë</span> ESCOLHA </div>
          </summary>
          <div class="w-content">
        <div style="margin-top: 3px;">Voc√™ pode enviar suas escolhas diretamente por mensagem, clicando em COPIAR SELE√á√ÉO, ou por aqui, atrav√©s do menu EDITAR SELE√á√ÉO. </div>
       
        <div style="margin-top: 8px;">Suas pe√ßas s√£o reservadas <strong>imediatamente</strong> ap√≥s o envio, por√©m este cat√°logo ser√° atualizado <strong>uma vez por dia</strong>.</div>
            
            <div style="margin-top: 8px;">Se quiser, selecione <strong>mais de 3 pe√ßas</strong> para ampliar suas indica√ß√µes em caso de duplicata.</div>
         
            <div style="margin-top: 8px;">Clique na lupa ‚åï  para saber mais sobre cada pe√ßa e em ‚Üª  para reorden√°-las na galeria! :)</div>
            </div>
        </details>

        <details class="w-details">
          <summary class="w-summary">
            <div style="display:flex; align-items:center;"><span class="w-icon" style="font-size: 24px; font-weight: 500; margin-top: -2px; margin-left: 2px;">‚ùê</span>RECEBIMENTO</div>
          </summary>
          <div class="w-content">
            <div style="margin-top: 3px;">As entregas e retiradas podem ser feitas at√© dia 20/12 ou a partir de 08/01. Se estiver pela regi√£o central de S√£o Paulo, mais f√°cil ainda!</div>
            <div style="margin-top: 8px;">Para outras localidades, os envios ser√£o combinados individualmente, com frete √† parte. </div>
            <div style="margin-top: 8px;">As pe√ßas s√£o entregues <strong>planificadas</strong>, contendo seus certificados e sugest√µes de montagem.</div>
          </div>
        </details>

        <details class="w-details">
          <summary class="w-summary">
            <div style="display:flex; align-items:center;"><span class="w-icon" style="font-size: 24px; font-weight: 500; margin-top: 3px; margin-left: 2px;">‚ßâ</span>APOIO</div>
          </summary>
          <div class="w-content">
            <div style="margin-top: 3px; font-weight: 700;">Quer dar mais uma for√ßa, propor alguma troca?</div>
            <div style="margin-top: 8px;">Conhe√ßa a <a href="#" onclick="goToDonation() ; return false;" style="color: red;"><strong>CARTELA DE DOA√á√ïES</strong></a><br />ou fale conosco!</div>
            <div style="margin-top: 8px;">PIX: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="a9cbccdddac1c6d9dddfe9cec4c8c0c587cac6c4">[email&#160;protected]</a></div>
          </div>
        </details>

      </div>
    </div>
  </section>

  <main id="app">
    <div style="padding:40px; text-align:center;">Carregando cat√°logo de pr√™mios...</div>
  </main>

  <footer id="main-footer">
      <div id="review-panel" class="review-panel">
    <div class="review-header">
      <span>Pe√ßas Selecionadas</span>
      <button class="btn-close-panel" onclick="toggleReviewPanel()">‚úï</button>
    </div>
    
    <div id="review-list" class="review-body">
      </div>
    
    <div style="padding: 15px; background: var(--beige); text-align: center;">
  <div class="review-footer">
  <button class="btn-submit" onclick="openFlow()" style="width:100%">
    ENVIAR
  </button>
</div>
    </div>
  </div>
    <span id="counter" class="pill-counter"></span>
    <button id="btn-finish" class="btn-submit" disabled></button>
  </footer>

  <input type="hidden" id="fNome"><input type="hidden" id="fEmail"><input type="hidden" id="fTelefone">
  <input type="hidden" id="fFav"> <input type="hidden" id="fTotal" value="0.00"> ```

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
/* ================= CONFIGURA√á√ïES GERAIS ================= */
const JSON_URL = 'https://betshoptv.com/dados/pecas.json';
const GAS_URL  = 'https://script.google.com/macros/s/AKfycbzel7_KO8q-hMGwWcTPd-112Z3NA2rDFiAHYgUIIc7lmZwkQITA36JHJET_xnerhAWZ/exec';

// Configura√ß√£o PIX
const PIX_CHAVE  = "betshoptv@gmail.com"; // Coloque sua chave real
const PIX_NOME   = "BETSHOPTV";
const PIX_CIDADE = "SAOPAULO";

/* ================= ESTADO DA APLICA√á√ÉO ================= */
let todasPecas = [];
let selecionados = []; 
let carrinho = {}; 
let valorLivre = 0;
let nomeUsuario = "";

// Cat√°logo Base (Item 1 tem pre√ßo din√¢mico)
const catalogoBase = [
  { id: 1, nome: "Pe√ßas selecionadas por voc√™ (M√©dia)", preco: 0 },
  { id: 2, nome: "Hora/Trabalho", preco: 150.00 },
  { id: 3, nome: "Luz (Dez/2025)", preco: 96.66 },
  { id: 4, nome: "Internet + Telefonia M√≥vel (M√©dia)", preco: 170.00 },
  { id: 5, nome: "Pacote de Softwares Criativos (Licen√ßa Anual)", preco: 2400.00 },
  { id: 6, nome: "Sess√£o de An√°lise (50min)", preco: 160.00 },
  { id: 7, nome: "Aluguel + Cond. + √Ågua (Dez/2025)", preco: 2000.01 },
  { id: 8, nome: "Gel M√©dium Acr√≠lico Fosco Corfix Arts (Pote 250ml)", preco: 63.87 },
  { id: 9, nome: "Ferragens sortidas", preco: 20.00 },
  { id: 10, nome: "Refugo de EVA (kg)", preco: 5.99 },
  { id: 11, nome: "EVA Estampado/Mesclado (M√©dia por Folha)", preco: 8.00 },
  { id: 12, nome: "Placa de EVA (100 x 200 cm)", preco: 209.90 },
  { id: 13, nome: "Montagem de pe√ßas em S√£o Paulo", preco: 450.00 },
  { id: 14, nome: "Embalagem personalizada", preco: 300.00 },
  { id: 15, nome: "Pe√ßa in√©dita de Chop Shop AV", preco: 1200.00 },
  { id: 16, nome: "Revista Playboy brasileira (Edi√ß√£o n¬∫ 175 + Frete)", preco: 273.38 },
  { id: 17, nome: "Soprador T√©rmico Digital", preco: 669.00 },
  { id: 18, nome: "Kit para Escultura em EVA", preco: 350.00 },
  { id: 19, nome: "Micro Ret√≠fica + Pontas Extras", preco: 245.00 },
  { id: 20, nome: "Pir√≥grafo", preco: 80.00 }
];
let catalogoAtual = JSON.parse(JSON.stringify(catalogoBase)); // C√≥pia segura

/* ================= INICIALIZA√á√ÉO (O CORA√á√ÉO) ================= */
async function init(){
  try {
    const res = await fetch(JSON_URL);
    const data = await res.json();
    
    // Filtra apenas pe√ßas dispon√≠veis
    todasPecas = data.filter(p => {
       const st = String(p.status || '').trim().toLowerCase();
       return !st.includes('vendid') && !st.includes('acervo');
    });
    
    // Aleat√≥rio na largada
    shuffleArray(todasPecas);
    
    // Renderiza a Galeria
    renderApp(); 
    
    // Ativa o Header Shrink
    setupHeaderScroll();

  } catch(e) {
    document.getElementById('app').innerHTML = '<h3 style="color:red;text-align:center;padding:50px;">Erro ao carregar dados.<br>Tente recarregar a p√°gina.</h3>';
    console.error(e);
  }
}

function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

/* ================= RENDERIZA√á√ÉO DA GALERIA ================= */
function renderApp(){
  const app = document.getElementById('app');
  app.innerHTML = '';
  app.appendChild(buildFilters());
  app.appendChild(buildGaleria());
}

function buildFilters(){
  const bar = document.createElement('div');
  bar.className = 'filters-bar';
  
  const btnShuffle = document.createElement('button');
  btnShuffle.className = 'chip';
  btnShuffle.innerHTML = '<span style="font-size: var(--destaque); vertical-align: middle; line-height: 0;">‚Üª</span>';
  btnShuffle.onclick = () => { shuffleArray(todasPecas); renderApp(); };
  bar.appendChild(btnShuffle);
  
  return bar;
}

function buildGaleria(){
  const container = document.createElement('div');
  container.className = 'galeria-container';
  const colunas = 3; 
  const cols = Array.from({length: colunas}, () => {
    const d = document.createElement('div'); d.className = 'gal-col'; return d;
  });
  cols.forEach(c => container.appendChild(c));

  todasPecas.forEach((p, idx) => {
    const item = document.createElement('div');
    item.className = 'gal-item';
    
    const selIdx = selecionados.indexOf(p.id_peca);
    if(selIdx !== -1) item.classList.add('selected');
    
    item.onclick = () => toggleSelection(p.id_peca);

    // Wrapper Visual
    const imgWrap = document.createElement('div');
    imgWrap.style.position = 'relative'; imgWrap.style.width = '100%';        
    item.appendChild(imgWrap);

    const img = new Image();
    img.src = `https://betshoptv.com/img/tmb/${p.imagens[0]}.avif`;
    img.onerror = function(){ this.onerror = null; this.src = `https://betshoptv.com/img/fallback/${p.imagens[0]}.jpg`; };
    imgWrap.appendChild(img);

    const badge = document.createElement('div');
    badge.className = 'selection-badge';
    badge.textContent = selIdx + 1; 
    imgWrap.appendChild(badge);

    const btnSpy = document.createElement('button');
    btnSpy.className = 'btn-spy';
    btnSpy.textContent = '‚åï';
    btnSpy.onclick = (e) => { e.stopPropagation(); openDetails(p.id_peca); };
    imgWrap.appendChild(btnSpy);

    const tit = document.createElement('div');
    tit.className = 'gal-titulo';
    tit.innerHTML = `<span class="gal-titulo-text">${p.titulo || `Pe√ßa ${p.id_peca}`}</span>`;
    item.appendChild(tit);

    cols[idx % colunas].appendChild(item);
  });
  return container;
}

/* ================= L√ìGICA DE SELE√á√ÉO & INTERFACE ================= */
function toggleSelection(id){
  const idx = selecionados.indexOf(id);
  if (idx === -1) selecionados.push(id);
  else selecionados.splice(idx, 1);
  updateAllUI();
}

function updateAllUI() {
  renderApp(); 
  updateFooter();
  if(document.getElementById('review-panel').classList.contains('open')) renderReviewList();
}

function updateFooter(){
  const counter = document.getElementById('counter');
  const btnFinish = document.getElementById('btn-finish');
  const btnCopy = document.getElementById('btn-copiar-selecao');
  const txtHidden = document.getElementById('lista-copiar-oculta');
  const count = selecionados.length;
  
  if(count > 0){
    btnFinish.disabled = false;
    btnFinish.textContent = `EDITAR SELE√á√ÉO (${count})`;
    btnFinish.onclick = toggleReviewPanel; 
    
    btnCopy.disabled = false;
    btnCopy.innerHTML = `COPIAR<br>SELE√á√ÉO (${count})`;
    btnCopy.style.backgroundColor = 'var(--red)';
    btnCopy.style.borderColor = 'var(--red)';
    btnCopy.style.color = 'var(--white)';
    btnCopy.style.cursor = 'pointer';
    
    txtHidden.value = selecionados.join('\n');
  } else {
    // Estado Inativo
    counter.style.display = 'none';
    
    btnFinish.disabled = true;
    btnFinish.textContent = 'SELECIONE SEUS PR√äMIOS'; 
    btnFinish.onclick = null;
    
    btnCopy.disabled = true;
    btnCopy.innerHTML = 'SELECIONE<br>P/ COPIAR';
    btnCopy.style.backgroundColor = 'var(--beige)';
    btnCopy.style.borderColor = 'var(--red)';
    btnCopy.style.color = 'var(--red)';
    btnCopy.style.cursor = 'default';
    
    txtHidden.value = '';
  }
}

/* ================= COPIAR P/ WHATSAPP ================= */
function copyListToClipboard() {
    const listaTxt = document.getElementById('lista-copiar-oculta').value;
    if (!listaTxt) { alert('A lista est√° vazia!'); return; }
    
navigator.clipboard.writeText(listaTxt).then(() => {
        const btn = document.getElementById('btn-copiar-selecao');
        const count = selecionados.length;
        
        // 1. Coloca o <br> aqui na vari√°vel
        const defaultText = `COPIAR<br>SELE√á√ÉO (${count})`;

        // Muda temporariamente para o aviso de sucesso
        btn.innerHTML = 'COPIADO! ‚úî'; // (Use innerHTML aqui tamb√©m pra garantir)
        btn.style.backgroundColor = 'var(--ink)';
        btn.style.borderColor = 'var(--ink)';
        btn.style.color = 'var(--beige)';
      
        setTimeout(() => {
            // 2. AQUI O SEGREDO: tem que ser innerHTML para o <br> funcionar na volta!
            btn.innerHTML = defaultText; 
            
            btn.style.backgroundColor = 'var(--red)';
            btn.style.borderColor = 'var(--red)';
            btn.style.color = 'var(--white)';
        }, 1500);
    });}

/* ================= PAINEL DE REVIS√ÉO (DRAWER) ================= */
function toggleReviewPanel() {
  const panel = document.getElementById('review-panel');
  panel.classList.toggle('open');
  if(panel.classList.contains('open')) renderReviewList();
}

function renderReviewList() {
  const container = document.getElementById('review-list');
  container.innerHTML = '';
  if (selecionados.length === 0) {
    container.innerHTML = '<div style="padding:40px; text-align:center; color:#999;">Lista vazia.</div>';
    return;
  }
  selecionados.forEach((id, index) => {
    const p = todasPecas.find(item => item.id_peca === id);
    if (!p) return;
    const div = document.createElement('div');
    div.className = 'review-item';
    div.innerHTML = `
      <div class="review-rank">#${index + 1}</div>
      <img src="https://betshoptv.com/img/tmb/${p.imagens[0]}.avif" class="review-thumb">
      <div class="review-info"><span class="review-title">${p.titulo}</span></div>
      <div class="review-actions">
        ${index > 0 ? `<button class="ctrl-btn" onclick="moveItem(${index}, -1)">‚ñ≤</button>` : '<div style="width:24px"></div>'}
        ${index < selecionados.length - 1 ? `<button class="ctrl-btn" onclick="moveItem(${index}, 1)">‚ñº</button>` : '<div style="width:24px"></div>'}
        <button class="ctrl-btn remove" onclick="removeItem(${index})">‚úï</button>
      </div>`;
    container.appendChild(div);
  });
}

function moveItem(index, direction) {
  const item = selecionados[index];
  selecionados.splice(index, 1);
  selecionados.splice(index + direction, 0, item);
  updateAllUI();
}
function removeItem(index) {
  selecionados.splice(index, 1);
  updateAllUI();
  if(selecionados.length === 0) toggleReviewPanel();
}

/* ================= FLUXO DE ENVIO (MODAIS) ================= */
function openFlow() {
    const panel = document.getElementById('review-panel');
    if(panel) panel.classList.remove('open');
    document.getElementById('qtd-confirma').textContent = selecionados.length;
    document.getElementById('main-modal').classList.add('open');
    showScreen('step-name');
}

function closeFlow() { document.getElementById('main-modal').classList.remove('open'); }
function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

/* ================= ENVIO PR√äMIOS ================= */
async function submitPremios(){
    const nomeInput = document.getElementById('final-nome');
    const nome = nomeInput.value.trim();
    const btn = document.getElementById('btn-envio-premios');
    
    if(!nome) { alert('Digite seu nome!'); nomeInput.focus(); return; }
    nomeUsuario = nome;

    btn.disabled = true; btn.textContent = 'ENVIANDO...';

    const lista = selecionados.map((id, index) => {
        const p = todasPecas.find(item => item.id_peca === id);
        return { ordem: index + 1, titulo: p ? `${p.id_peca} - ${p.titulo}` : id };
    });

    const fd = new FormData();
    fd.append('tipo', 'PREMIO');
    fd.append('nome', nome);
    fd.append('conteudo', JSON.stringify(lista));

    try {
        await fetch(GAS_URL, { method:'POST', body:fd });
        showScreen('step-success');
    } catch(err) {
        console.error(err); alert('Erro ao enviar.');
        btn.disabled = false; btn.textContent = 'ENVIAR SELE√á√ÉO';
    }
}

/* ================= DOA√á√ÉO & C√ÅLCULO ================= */
function goToDonation() {
    document.getElementById('main-modal').classList.add('open'); 
    nomeUsuario = nomeUsuario || "Colaborador R√°pido"; 
    calculateDynamicPrice();
    renderList();
    showScreen('step-donation');
}

/* ================= C√ÅLCULO DE PRE√áO CORRIGIDO (M√âDIA SIMPLES) ================= */
function calculateDynamicPrice() {
    let soma = 0; 
    let count = 0;

    selecionados.forEach(id => {
        const p = todasPecas.find(item => item.id_peca === id);
        // Garante que o pre√ßo seja tratado como n√∫mero
        if (p && p.preco) { 
            soma += parseFloat(p.preco); 
            count++; 
        }
    });

    // M√©dia Simples: Soma total dividido pela quantidade de pe√ßas
    const precoFinal = count > 0 ? (soma / count) * 3 : 0;
    
    // Atualiza o item 1 do cat√°logo
    const item1 = catalogoAtual.find(i => i.id === 1);
    if(item1) item1.preco = precoFinal;
}


// L√ìGICA DE DIVIS√ÉO DO PRE√áO (Item < 0)
/* ================= L√ìGICA DE QUANTIDADE (GANGORRA DO ¬Ω) ================= */
/* ================= L√ìGICA DE QUANTIDADE (ESCADINHA DAS FRA√á√ïES) ================= */
function updateQty(id, delta) {
    if (!carrinho[id]) carrinho[id] = 0;
    const item = catalogoAtual.find(i => i.id === id);
    if (!item) return;

    // Se _fracao n√£o existe, assume 1 (inteiro)
    if (!item._fracao) item._fracao = 1;

    // --- CLICOU NO MAIS (+) ---
    // Caminho: 1/8 -> 1/4 -> 1/2 -> 0 -> 1 -> 2 ...
    if (delta > 0) {
        if (carrinho[id] === 1 && item._fracao > 1) {
            // Estamos nas fra√ß√µes, vamos subir
            if (item._fracao === 8) item._fracao = 4;      // 1/8 -> 1/4
            else if (item._fracao === 4) item._fracao = 2; // 1/4 -> 1/2
            else if (item._fracao === 2) {                 // 1/2 -> 0
                item._fracao = 1;
                carrinho[id] = 0;
            }
        } else {
            // Vida normal (0 -> 1 -> 2...)
            carrinho[id]++;
            item._fracao = 1; 
        }

    // --- CLICOU NO MENOS (-) ---
    // Caminho: ... 2 -> 1 -> 0 -> 1/2 -> 1/4 -> 1/8
    } else {
        if (carrinho[id] === 0) {
            // Entra no "Submundo" das fra√ß√µes (0 -> 1/2)
            if (item.preco > 0) {
                carrinho[id] = 1; // Ativa visualmente
                item._fracao = 2; // Define divisor como 2
            }
        } else if (carrinho[id] === 1 && item._fracao > 1) {
            // Desce a escadinha das fra√ß√µes
            if (item._fracao === 2) item._fracao = 4;      // 1/2 -> 1/4
            else if (item._fracao === 4) item._fracao = 8; // 1/4 -> 1/8
            // Se j√° √© 8 (1/8), n√£o faz nada (trava no fundo)
        } else {
            // Vida normal (3 -> 2 -> 1 -> 0)
            carrinho[id]--;
            if (carrinho[id] === 0) item._fracao = 1;
        }
    }
    
    // Seguran√ßa
    if (carrinho[id] < 0) carrinho[id] = 0;
    
    renderList();
}


/* ================= RENDERIZA√á√ÉO (COM S√çMBOLOS CHIQ) ================= */
function renderList() {
    const container = document.getElementById('donation-list');
    container.innerHTML = '';
    
    catalogoAtual.forEach(item => {
      const qtd = carrinho[item.id] || 0;
      const divisor = item._fracao || 1;
      
      // 1. Define o Pre√ßo Visual
      // Se tiver fra√ß√£o, divide o pre√ßo. Sen√£o, pre√ßo cheio.
      const precoReal = item.preco / divisor;
      const precoStr = precoReal.toLocaleString('pt-BR', {minimumFractionDigits: 2});

      // 2. Define o S√≠mbolo da Quantidade
      let displayQtd = qtd;
      if (qtd === 1 && divisor > 1) {
          if (divisor === 2) displayQtd = '¬Ω';
          if (divisor === 4) displayQtd = '¬º';
          if (divisor === 8) displayQtd = '‚Öõ';
      }
      
      const div = document.createElement('div');
      div.className = 'donation-item';
      div.innerHTML = `
        <div class="donation-info">
            <span class="d-name">${item.nome}</span>
            <span class="d-price">R$ ${precoStr}</span>
        </div>
        <div class="d-controls">
          <div class="d-btn" onclick="updateQty(${item.id}, -1)">-</div>
          <span class="d-qty" style=" font-size:1.1em;">${displayQtd}</span>
          <div class="d-btn" onclick="updateQty(${item.id}, 1)">+</div>
        </div>`;
      container.appendChild(div);
    });
    updateTotal();
}

function updateFreeValue() {
    const input = document.getElementById('free-input');
    let val = parseFloat(input.value.replace(',', '.'));
    if (isNaN(val) || val < 0) val = 0;
    valorLivre = val;
    updateTotal();
}

/* ================= C√ÅLCULO TOTAL (FRA√á√ïES) ================= */
function updateTotal() {
    let totalItens = 0;
    
    catalogoAtual.forEach(item => {
        const qtd = carrinho[item.id] || 0;
        const divisor = item._fracao || 1; // Se n√£o tiver, divide por 1 (neutro)
        
        // A matem√°tica √© simples: (Quantidade * Pre√ßo) / Divisor
        // Se qtd=1 e divisor=4 (1/4), ele soma (1 * Pre√ßo) / 4
        totalItens += (qtd * item.preco) / divisor;
    });

    const totalGeral = totalItens + (valorLivre || 0);
    const txtValor = totalGeral.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
    
    document.getElementById('total-display').textContent = txtValor;
    const btnPix = document.getElementById('btn-pix');
    
    if(totalGeral > 0) {
        btnPix.disabled = false;
        btnPix.textContent = `PAGAR`;
    } else {
        btnPix.disabled = true;
        btnPix.textContent = "GERAR PIX";
    }
}

function addCustomItem() {
    const desc = document.getElementById('custom-desc').value;
    const val = parseFloat(document.getElementById('custom-val').value.replace(',', '.'));
    if(!desc || isNaN(val) || val <= 0) return alert('Preencha corretamente.');
    const newId = Date.now();
    catalogoAtual.push({ id: newId, nome: desc, preco: val });
    carrinho[newId] = 1;
    document.getElementById('custom-desc').value = '';
    document.getElementById('custom-val').value = '';
    goToDonation();
}

function openCustomItem() { showScreen('step-custom'); }

/* ================= ENVIO DOA√á√ÉO & PIX ================= */
/* ================= ENVIO DOA√á√ÉO & PIX (CORRIGIDO PARA FRA√á√ïES) ================= */
async function submitDonation() {
    const itensEscolhidos = [];
    let totalParaPix = 0;

    // 1. Prepara os dados (Aplicando a matem√°tica das fra√ß√µes)
    catalogoAtual.forEach(item => {
        const qtd = carrinho[item.id] || 0;
        const divisor = item._fracao || 1; // Se n√£o tiver fra√ß√£o, divide por 1

        if(qtd > 0) {
            // O pre√ßo unit√°rio real √© o pre√ßo base dividido pela fra√ß√£o
            const precoReal = item.preco / divisor;
            const subtotal = precoReal * qtd;

            totalParaPix += subtotal;

            itensEscolhidos.push({ 
                nome: item.nome + (divisor > 1 ? ` (1/${divisor})` : ""), // Avisa na planilha se for fra√ß√£o
                preco: precoReal, 
                qtd: qtd, 
                subtotal: subtotal 
            });
        }
    });

    // 2. Adiciona valor livre
    if(valorLivre > 0) {
        itensEscolhidos.push({ 
            nome: "Doa√ß√£o Livre", 
            preco: valorLivre, 
            qtd: 1, 
            subtotal: valorLivre 
        });
        totalParaPix += valorLivre;
    }

    // Valida√ß√£o de Seguran√ßa
    if(totalParaPix <= 0) { 
        alert("O valor total deve ser maior que zero."); 
        return; 
    }

    // 3. UI Loading
    const btn = document.getElementById('btn-pix');
    btn.textContent = "GERANDO PIX...";
    btn.disabled = true;

    // 4. Envia para Planilha (Google Sheets)
    const fd = new FormData();
    fd.append('tipo', 'DOACAO');
    fd.append('nome', nomeUsuario);
    fd.append('conteudo', JSON.stringify(itensEscolhidos));

    try {
        // Envia dados em background
        fetch(GAS_URL, { method:'POST', body:fd }).catch(e => console.error("Erro planilha silencioso", e));
        
        // 5. GERA O PIX COM O VALOR EXATO
        // O .toFixed(2) dentro da fun√ß√£o gerarPixPayload vai arredondar centavos corretamente
        const payload = gerarPixPayload(PIX_CHAVE, PIX_NOME, PIX_CIDADE, totalParaPix);
        
        // Atualiza a tela do PIX
        document.getElementById('pix-copia-cola').value = payload;
        document.getElementById('pix-valor-display').textContent = totalParaPix.toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'});
        document.getElementById('pix-qr-img').src = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(payload)}`;
        
        // Mostra a tela
        showScreen('step-pix');

    } catch(err) {
        console.error(err); 
        alert('Erro ao processar.');
        btn.disabled = false; 
        btn.textContent = 'GERAR PIX';
    }
}
/* ================= UTILIT√ÅRIOS (Header, Pix Payload, Etc) ================= */
function setupHeaderScroll() {
  window.addEventListener('scroll', () => {
    const header = document.querySelector('header');
    if (window.scrollY > 10) header.classList.add('scrolled');
    else header.classList.remove('scrolled');
  });
}

function gerarPixPayload(chave, nome, cidade, valor) {
  const format = (id, val) => id + val.length.toString().padStart(2,'0') + val;
  const valorStr = valor.toFixed(2);
  let payload = 
    format('00', '01') +                           
    format('26', format('00', 'BR.GOV.BCB.PIX') + format('01', chave)) +
    format('52', '0000') + format('53', '986') + format('54', valorStr) +                       
    format('58', 'BR') + format('59', nome) + format('60', cidade) +                         
    format('62', format('05', '***'));             
  payload += '6304';
  let crc = 0xFFFF;
  for (let i = 0; i < payload.length; i++) {
    crc ^= payload.charCodeAt(i) << 8;
    for (let j = 0; j < 8; j++) {
      if ((crc & 0x8000) !== 0) crc = (crc << 1) ^ 0x1021;
      else crc = crc << 1;
    }
  }
  return payload + (crc & 0xFFFF).toString(16).toUpperCase().padStart(4, '0');
}

/* ================= COPIAR PIX (REA√á√ÉO SECA) ================= */
function copyPixCode() {
  const input = document.getElementById('pix-copia-cola');
  const btn = document.getElementById('btn-copy-action');
  
  // Seleciona e Copia
  input.select(); 
  input.setSelectionRange(0, 99999); // Mobile
  navigator.clipboard.writeText(input.value);
  
  // Rea√ß√£o do Bot√£o
  const originalText = btn.textContent;
  
  btn.textContent = 'COPIADO!';
  btn.style.backgroundColor = 'var(--red)';
  btn.style.color = 'var(--white)';
  
  // Reseta depois de 2 segundos
  setTimeout(() => {
    btn.textContent = originalText;
    btn.style.backgroundColor = ''; // Volta ao CSS original (Ink)
    btn.style.color = '';
  }, 2000);
}
// Detalhes (Galeria Swipe)
let currentDetailId = null;
function openDetails(id) {
  const p = todasPecas.find(item => item.id_peca === id);
  if (!p) return;
  currentDetailId = id;
  document.getElementById('det-title').textContent = p.titulo;
  document.getElementById('det-tech').textContent = p.tecnica;
  document.getElementById('det-dim').textContent = p.dimensao;
  updateModalBtnState();
  
  const container = document.getElementById('det-scroll-container');
  const dotsContainer = document.getElementById('det-dots');
  container.innerHTML = ''; dotsContainer.innerHTML = '';
  const listaImagens = Array.isArray(p.imagens) ? p.imagens : [p.imagens];
  
  listaImagens.forEach((imgName, index) => {
    const img = document.createElement('img'); img.className = 'details-img';
    img.src = `https://betshoptv.com/img/otm/${imgName}.avif`;
    img.onerror = function(){ this.src = `https://betshoptv.com/img/fallback/${imgName}.jpg`; };
    container.appendChild(img);
    if(listaImagens.length > 1){
        const dot = document.createElement('div'); dot.className = 'dot';
        if(index === 0) dot.classList.add('active');
        dotsContainer.appendChild(dot);
    }
  });
  dotsContainer.style.display = listaImagens.length > 1 ? 'flex' : 'none';
  container.scrollLeft = 0;
  container.onscroll = () => {
      if(listaImagens.length <= 1) return;
      const index = Math.round(container.scrollLeft / container.offsetWidth);
      const dots = document.querySelectorAll('.dot');
      dots.forEach((d, i) => d.classList.toggle('active', i === index));
  };
  document.getElementById('modal-details').classList.add('open');
}

function handleModalSelect() {
    if(!currentDetailId) return;
    toggleSelection(currentDetailId);
    updateModalBtnState();
}
function updateModalBtnState() {
    const btn = document.getElementById('btn-det-select');
    const isSelected = selecionados.includes(currentDetailId);
    if(isSelected) { btn.textContent = 'REMOVER'; btn.classList.add('is-selected'); }
    else { btn.textContent = 'SELECIONAR'; btn.classList.remove('is-selected'); }
}
function closeDetails(e, force) {
  if (force || e.target.id === 'modal-details') document.getElementById('modal-details').classList.remove('open');
}

// Boas Vindas
function closeWelcome() {
  const modal = document.getElementById('modal-welcome');
  modal.style.opacity = '0';
  setTimeout(() => { modal.classList.remove('open'); modal.style.display = 'none'; }, 300);
}

// Inicializa
window.addEventListener('DOMContentLoaded', init);
</script>



<div id="main-modal" class="envio-modal-overlay">
  <div class="envio-card">
    <button onclick="closeFlow()" style="position:absolute; top:10px; right:15px; border:0; background:none; font-size:1.5rem; cursor:pointer;">‚úï</button>

<div id="step-pix" class="screen">
      <div class="envio-title">Pagamento via PIX</div>
      <p class="envio-desc">Escaneie ou copie o c√≥digo abaixo.</p>
      
      <div class="pix-wrapper">
        
        <div>
          <span class="pix-label">VALOR TOTAL</span>
          <div class="pix-value" id="pix-valor-display">R$ 0,00</div>
        </div>

        <div class="pix-qr-frame">
          <img id="pix-qr-img" class="pix-img" src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" alt="QR Code">
        </div>

        <div class="pix-copy-box">
          <input type="text" id="pix-copia-cola" class="pix-input" readonly value="Aguardando...">
          <button id="btn-copy-action" class="pix-btn-copy" onclick="copyPixCode()">COPIAR</button>
        </div>

      </div>
    </div>
    <div id="step-name" class="screen active">
      <div class="envio-title">Voc√™ escolheu <strong id="qtd-confirma">0</strong> pe√ßas!</div>
      <p class="envio-desc">
        Qual seu nome?
      </p>
      <input type="text" id="final-nome" class="input-field" placeholder="‚ô•" autocomplete="name">
      <button id="btn-envio-premios" class="btn-confirm" onclick="submitPremios()">ENVIAR SELE√á√ÉO</button>
    </div>

    <div id="step-success" class="screen">
      <div class="envio-title" style="color:var(--ink)">Sucelso!</div>
      <p class="envio-desc">Em breve combinaremos o recebimento das pe√ßas. 
        <br /><font style="margin-top: 18px;">Agradecemos sua participa√ß√£o e desejamos uma √≥tima passagem de ano!</font></p>
      <div style="background:#f4f4f4; padding:15px; border:1px dashed var(--ink); margin-bottom:15px;">

        <p style="margin:0 0 10px 0; font-weight:500; color:var(--ink); font-size: 0.94em;">A <a href="https://betshoptv.com/#galeria" target="_blank" style="color: red;"><strong>BetShopTV.com</strong></a> seguir√° ativa!</p>
        <p style="margin:0 0 10px 0; font-weight:400; color:var(--ink); font-size: 0.88em;">Quer colaborar com a continuidade deste e outros projetos associados? Propor alguma troca? Presentear algu√©m?</p>
        <p style="margin:0 0 10px 0; font-weight:400; color:var(--ink); font-size: 0.88em;">As pe√ßas de <strong><em>Chop Shop AV</em></strong> seguem √† venda na <a href="https://betshoptv.com/#galeria" target="_blank" style="color: red;"><strong>Galeria de Ofertas</strong></a>!</p>
        <br><p style="margin:0 0 10px 0; font-weight:500; color:var(--ink); font-size: 0.94em;">Para colaborar de outras formas: </p>
        <button class="btn-confirm" onclick="goToDonation()" style="background: red;">CARTELA DE DOA√á√ïES</button>
      </div>
      <button class="btn-confirm" onclick="closeFlow()" style="max-width: 50%; font-size: 11px; font-weight: 420; color: #2b2424; background: #bebab0;">Concluir</button>
    </div>

    <div id="step-donation" class="screen">
      <h2 style="text-align:left; font-size:1.2rem; border-bottom:1px solid #eee; padding-bottom:10px; margin-bottom:15px; color:var(--red); font-family:var(--ff-cta);"><font style="background: red; color: white; padding: 8px 12px;">CARTELA DE DOA√á√ïES</font></h2>
      
      <div class="free-value-box">
        <label class="free-label">Quero definir uma quantia:</label>
        <div class="free-input-wrapper">
          <span style="font-size:1.4rem; font-weight:700; margin-right:5px;">R$</span>
          <input type="number" id="free-input" placeholder="0,00" oninput="updateFreeValue()">
        </div>
      </div>
      <div style="text-align: left;">
      <h2 style="font size: 0.8em;">ITENS</h2>
<p style="margin-top: -13px; margin-bottom: 8px; padding: 4px 0px; font-weight:420; color:var(--ink); font-size: 0.88em;">Abaixo √© poss√≠vel selecionar fra√ß√µes das quantias no bot√£o <strong>‚Äî</strong>, al√©m de incluir propostas personalizadas em sua doa√ß√£o! </p>
     </div>
     
      <div class="donation-list-container" id="donation-list"></div>

      <button class="custom-item-btn" onclick="openCustomItem()"><span>+</span> Adicionar item personalizado</button>
<br>
      <div class="total-bar">
        TOTAL: <div class="total-val" id="total-display">R$ 0,00</div>
        <button class="btn-pay" id="btn-pix" disabled onclick="submitDonation()">GERAR PIX</button>
      </div>
    </div>

    <div id="step-custom" class="screen">
      <div class="envio-title">Item Personalizado</div>
      <input type="text" id="custom-desc" class="input-field" placeholder="Nome e/ou descri√ß√£o do item">
      <input type="number" id="custom-val" class="input-field" placeholder="üí∏ üí∏ üí∏">
      <button class="btn-confirm" onclick="addCustomItem()">ADICIONAR √Ä LISTA</button>
      <button class="btn-cancel" onclick="goToDonation()">Cancelar</button>
    </div>
  </div>
  
    
    
</div>




<div id="modal-details" class="details-overlay" onclick="closeDetails(event)">
  <div class="details-card">
    <button class="btn-close-details" onclick="closeDetails(null, true)">‚úï</button>
    
    <div class="details-img-container" id="det-scroll-container">
       </div>

    <div id="det-dots" class="car-dots-area"></div>
    
    <div class="details-info">
      <div class="details-header-row">
        
        <div class="details-texts">
          <div id="det-title" class="details-title"></div>
          <div id="det-tech" class="details-tech"></div>
          <div id="det-dim" class="details-dim"></div>
        </div>

        <button id="btn-det-select" class="btn-modal-select" onclick="handleModalSelect()">
          SELECIONAR
        </button>

      </div>
    </div>
  </div>
</div>

<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"version":"2024.11.0","token":"f27ea51c9a684f4fbfb255dbc4c4de38","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}' crossorigin="anonymous"></script>
</body>
</html>
